{% extends 'base.html.twig' %}
{% block title %}Admin — Messages{% endblock %}

{% block stylesheets %}
  {{ parent() }}
  <style>
    /* Style aligné aux autres écrans admin : Poppins, texte noir, bords droits */
    .admin-messages, .admin-messages *{ font-family:'Poppins',sans-serif; color:#000; }

    .admin-messages{ max-width:1000px; margin:40px auto; padding:0 20px; }
    .admin-messages h1{ margin:0 0 16px; font-size:26px; font-weight:700; letter-spacing:.2px; }

    .table{
      width:100%;
      border-collapse:collapse;
      border:1px solid #000;            /* bords droits */
      background:#fff;
    }
    .table thead th{
      text-align:left;
      padding:12px;
      border-bottom:1px solid #000;
      font-weight:600;
    }
    .table tbody td{
      padding:12px;
      border-top:1px solid #000;
      vertical-align:top;
      line-height:1.4;
    }
    .table tr:hover td{ background:#f8fafc; } /* léger hover */

    .muted{ color:#6b7280; }
    .nowrap{ white-space:nowrap; }
    .prewrap{ white-space:pre-wrap; }

    /* Petits badges/puces si besoin (non utilisés ici mais prêts) */
    .badge{ display:inline-block; padding:4px 8px; border:1px solid #000; border-radius:0; background:#000; color:#fff; font-weight:600; font-size:12px; line-height:1; }
  </style>
{% endblock %}

{% block body %}
<div class="admin-messages">
  <h1>Messages de contact</h1>

  <table class="table" aria-label="Messages envoyés via le formulaire de contact">
    <thead>
      <tr>
        <th>Date</th>
        <th>Nom</th>
        <th>Email</th>
        <th>Message</th>
      </tr>
    </thead>
    <tbody>
      {% set tz = 'Europe/Paris' %}
      {% for r in rows %}
        <tr>
          {# IMPORTANT : le champ s’appelle createdAt (et pas ts) #}
          <td class="nowrap">
            {% if r.createdAt is defined and r.createdAt %}
              {{ r.createdAt|date('Y-m-d H:i', tz) }}
            {% else %}
              <span class="muted">—</span>
            {% endif %}
          </td>
          <td>{{ r.name ?? '-' }}</td>
          <td>
            {% if r.email %}
              <a href="mailto:{{ r.email }}">{{ r.email }}</a>
            {% else %}
              <span class="muted">—</span>
            {% endif %}
          </td>
          <td class="prewrap">
            {{ r.message ?? '-' }}
          </td>
        </tr>
      {% else %}
        <tr>
          <td colspan="4" class="muted" style="padding:12px;">Aucun message.</td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}

